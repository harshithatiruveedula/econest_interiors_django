{% extends 'main/base.html' %}
{% load static %}

{% block content %}

<section class="section">
  <div class="container">
    <div style="text-align: center; margin-bottom: 20px;">
      <h2 style="margin-bottom: 10px;">Admin Dashboard</h2>
      <p style="color: #666; margin: 0;">Welcome{% if user.is_authenticated %}, {{ user.username|default:"Admin" }}{% endif %}! Manage your consultations here.</p>
    </div>

    <div class="grid" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;">

      <div class="card" style="padding:20px;background:#f7f7f7;border-radius:10px;">
        <h3>Total Bookings</h3>
        <p style="font-size:24px;font-weight:bold;">{{ total_bookings }}</p>
      </div>

      <div class="card" style="padding:20px;background:#f7f7f7;border-radius:10px;">
        <h3>Total Services</h3>
        <p style="font-size:24px;font-weight:bold;">{{ total_services }}</p>
      </div>

      <div class="card" style="padding:20px;background:#f7f7f7;border-radius:10px;">
        <h3>Total Gallery Images</h3>
        <p style="font-size:24px;font-weight:bold;">{{ total_images }}</p>
      </div>

      <div class="card" style="padding:20px;background:#f7f7f7;border-radius:10px;">
        <h3>Total Blog Posts</h3>
        <p style="font-size:24px;font-weight:bold;">{{ total_posts }}</p>
      </div>

    </div>

    <h3 style="margin-top:40px;margin-bottom:15px;">All Bookings ({{ total_bookings }})</h3>

    <table style="width:100%;border-collapse:collapse;">
      <tr style="background:#333;color:#fff;">
        <th style="padding:10px;border:1px solid #ccc;">ID</th>
        <th style="padding:10px;border:1px solid #ccc;">Name</th>
        <th style="padding:10px;border:1px solid #ccc;">Email</th>
        <th style="padding:10px;border:1px solid #ccc;">Phone</th>
        <th style="padding:10px;border:1px solid #ccc;">Service</th>
        <th style="padding:10px;border:1px solid #ccc;">Preferred Date</th>
        <th style="padding:10px;border:1px solid #ccc;">Submitted At</th>
        <th style="padding:10px;border:1px solid #ccc;">Actions</th>
      </tr>

      {% for b in all_bookings %}
      <tr>
        <td style="padding:10px;border:1px solid #ccc;">{{ b.id }}</td>
        <td style="padding:10px;border:1px solid #ccc;">{{ b.name }}</td>
        <td style="padding:10px;border:1px solid #ccc;">{{ b.email }}</td>
        <td style="padding:10px;border:1px solid #ccc;">{{ b.phone }}</td>
        <td style="padding:10px;border:1px solid #ccc;">{{ b.service }}</td>
        <td style="padding:10px;border:1px solid #ccc;color:#0066cc;font-weight:bold;">
          {% if b.appointment_date %}
            {{ b.appointment_date|date:"F d, Y" }}
          {% else %}
            <span style="color:#999;">Not specified</span>
          {% endif %}
        </td>
        <td style="padding:10px;border:1px solid #ccc;">{{ b.submitted_at|date:"F d, Y g:i A" }}</td>
        <td style="padding:10px;border:1px solid #ccc;">
          <a href="{% url 'edit_consultation' b.id %}" style="background:#0066cc;color:#fff;padding:5px 10px;text-decoration:none;border-radius:3px;margin-right:5px;display:inline-block;">Edit</a>
          <a href="{% url 'delete_consultation' b.id %}" style="background:#cc0000;color:#fff;padding:5px 10px;text-decoration:none;border-radius:3px;display:inline-block;" onclick="return confirm('Are you sure you want to delete this consultation?');">Delete</a>
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="8" style="padding:10px;border:1px solid #ccc;text-align:center;">No bookings yet</td>
      </tr>
      {% endfor %}

    </table>

  </div>
</section>

{% endblock %}
